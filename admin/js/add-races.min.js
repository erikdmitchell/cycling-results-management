var counter=0,totalRaces=0,races=[];function addRace(e){jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"add_race_to_db",race:e},success:function(e){processRaceResponse(e),races.length?addRace(races.shift()):finishProgressBar()},error:function(e){processRaceResponse(e),races.length?addRace(races.shift()):finishProgressBar()}})}function processRaceResponse(e){jQuery("#get-race-data").append(e),updateProgressBar(++counter,totalRaces)}function updateProgressBar(e,a){jQuery("#get-race-data").find("#counter span.ctr").text(e)}function finishProgressBar(){}jQuery(document).ready(function(t){t(".button#add-file").click(function(e){e.preventDefault();wp.media.editor.send.attachment,wp.media.editor.send.attachment;var a=t(this);return!0,wp.media.editor.send.attachment=function(e,a){t("input#file").val(a.url)},wp.media.editor.open(a),!1}),t(".process-results #process-results").on("click",function(e){e.preventDefault();var a=t("form.process-results #race-id").val(),s=t("form.process-results #races-list").val(),r={action:"process_csv_results",form:t("form.process-results").serializeArray()};""==a&&(a=s[0]),t.post(ajaxurl,r,function(e){t("form#csv-data #race_id").val(a),t("span#csv-data-form-table").html(e),t(".uci-results .button#add-results").show()})}),t("input#race-search").live("keyup",function(){if(!(this.value.length<3)){var e={action:"race_id_search",string:this.value};t.post(ajaxurl,e,function(e){t(".process-results #race-search-list").html(""),t(".process-results #race-search-list").html(e)})}}),t("#csv-data #add-results").on("click",function(e){e.preventDefault(),showLoader("#wpcontent");var a={action:"csv_add_results",data:t("#csv-data").serialize()};t.post(ajaxurl,a,function(e){hideLoader(),window.location.replace(e)})})});